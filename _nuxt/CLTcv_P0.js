import{u as D,c as d,o as $,a as g,b as p,d as t,F as x,n as C,e as q,f as N,g as A,h as v,i as U,q as E,w as F,j,k as M,l as R,m as w,p as s,r as H,t as k,s as T}from"#entry";import{u as K,a as B}from"./Bpf_WSIJ.js";import{u as Y}from"./BgnocPFC.js";const z={__name:"CTAPayChangu",props:["totalPrice","isUserAuthenticated"],setup(_){const l=D().public.PAYCHANGU_KEY,n=_,h=d(()=>Number(n.totalPrice)||0),f=d(()=>n.isUserAuthenticated);$(async()=>{if(!(typeof window>"u"|h.value<0)&&!window.PaychanguCheckout){const o=document.createElement("script");o.src="https://in.paychangu.com/js/popup.js",o.async=!0,document.body.appendChild(o)}});async function i(){if(typeof window.PaychanguCheckout!="function"){console.error("PayChangu SDK not yet loaded");return}const o="TX-"+Math.floor(Math.random()*1e9+1);window.PaychanguCheckout({public_key:l,tx_ref:o,amount:1e3,currency:"MWK",callback_url:"http://localhost:3000/success",return_url:"http://localhost:3000/order-cancel",customer:{email:"yourmail@example.com",first_name:"Mac",last_name:"Phiri"},customization:{title:"Test Payment",description:"Payment Description"},meta:{uuid:crypto.randomUUID(),response:"Response"}})}async function c(){f.value?await i():C("/profile")}return(o,a)=>(p(),g(x,null,[t("button",{onClick:c,class:"px-6 py-3 text-center text-sm uppercase w-full rounded font-bold bg-pottery-light-primary text-white hover:bg-pottery-light-primaryHover active:bg-pottery-light-primaryActive dark:bg-pottery-dark-primary dark:hover:bg-pottery-dark-primaryHover dark:active:bg-pottery-dark-primaryActive focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-pottery-light-accent dark:focus:ring-pottery-dark-accent focus:ring-offset-pottery-light-bg dark:focus:ring-offset-pottery-dark-bg"}," Pay with Paychangu "),a[0]||(a[0]=t("div",{id:"wrapper"},null,-1))],64))}},I=()=>{const{$auth:_,$db:r}=q(),{user:l}=K(),n=N("stripe_products",()=>[]);async function h(){const c=E(v(r,"products"),F("active","==",!0)),a=(await j(c)).docs.map(async y=>{let u=y.data();const e=v(y.ref,"prices"),b=(await j(e)).docs[0];return u.priceId=b?.id,u.priceInfo=b?.data(),u});return n.value=await Promise.all(a),n.value}async function f(c,o){let a={price:c,mode:"payment",success_url:window.location.origin+"/sucess",cancel_url:window.location.origin+"/order-cancel"};o&&(a.mode="payment");const y=await A(v(r,`customers/${l.value?.uid}/checkout_sessions`),a);U(y,u=>{const e=u.data();if(e){if(e.error){console.error(e.error.message);return}e.url&&window.location.assign(e.url)}})}async function i(c,o){let a={line_items:c,mode:"payment",success_url:window.location.origin+"/sucess",cancel_url:window.location.origin+"/order-cancel"};o&&(a.mode="payment");const y=await A(v(r,`customers/${l.value?.uid}/checkout_sessions`),a);U(y,u=>{const e=u.data();if(e){if(e.error){console.error(e.error.message);return}e.url&&window.location.assign(e.url)}})}return{products:n,getCurrentProducts:h,launchCheckoutSession:i,launchCheckoutSingleSession:f}},O="price_1RhGRQFhIvatMWOAhvvRr1bb",Q=M({__name:"Stripe",props:["totalPrice","isUserAuthenticated"],setup(_){const{launchCheckoutSession:r}=I();D().public.STRIPE_KEY;const n=_;d(()=>Number(n.totalPrice)||0);const h=d(()=>n.isUserAuthenticated);async function f(){await r([{price:O,quantity:2}],!0)}function i(){h.value?(console.log("Executing Payment Now!!"),f()):C("/profile")}return(c,o)=>(p(),g(x,null,[t("button",{onClick:i,class:"px-6 py-3 text-center text-sm uppercase w-full rounded font-bold bg-pottery-light-primary text-white hover:bg-pottery-light-primaryHover active:bg-pottery-light-primaryActive dark:bg-pottery-dark-primary dark:hover:bg-pottery-dark-primaryHover dark:active:bg-pottery-dark-primaryActive focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-pottery-light-accent dark:focus:ring-pottery-dark-accent focus:ring-offset-pottery-light-bg dark:focus:ring-offset-pottery-dark-bg"}," Pay with Stripe "),o[0]||(o[0]=t("div",{id:"checkout-container"},null,-1))],64))}}),G=Object.assign(Q,{__name:"CTAStripe"}),V={class:"flex flex-col justify-center items-center rounded overflow-hidden mb-4 p-4"},W={class:"flex pb-2 w-full justify-end"},L={class:"flex pb-2 w-full justify-between"},X={key:0,class:"py-4"},J={class:"flex gap-6 py-2"},Z={class:"shadow-sm"},tt={class:"w-full md:w-3/4"},et={class:"flex justify-around items-center gap-2 py-2"},ot=["onClick"],st=["onClick"],rt={class:"flex justify-around items-center py-2"},nt=["onClick"],at={class:"p-4 mx-auto w-full md:w-1/2"},it={class:"flex justify-between"},ct={class:"flex flex-col gap-1"},ft={__name:"cart",setup(_){const r=Y(),{authStatus:l}=B(),n=d(()=>l?.value??!1),h=d(()=>r.items??[]),f=d(()=>r.count??0);let i=d(()=>r.total??0);const c=()=>{r.clear()},o=u=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"USD"}).format(u),a=d(()=>o(i.value));function y(){C("/profile")}return(u,e)=>{const P=z,b=G;return p(),g("div",null,[t("div",V,[t("div",W,[t("button",{onClick:R(y,["prevent"]),class:"text-sm font-bold uppercase text-pottery-light-primary dark:text-pottery-dark-primary"},"Profile")]),t("div",L,[e[0]||(e[0]=t("h2",{class:"text-2xl font-bold py-4"},"Cart",-1)),s(f)!=0?(p(),g("button",{key:0,onClick:R(c,["prevent"]),class:"text-sm font-bold uppercase text-pottery-light-primary dark:text-pottery-dark-primary"},"Clear Cart")):w("",!0)]),s(f)===0?(p(),g("p",X,"Your cart is currently empty.")):(p(!0),g(x,{key:1},H(s(h),(m,ut)=>(p(),g("div",J,[e[1]||(e[1]=t("img",{class:"size-24 md:size-40",src:"https://mdn.github.io/shared-assets/images/examples/balloons.jpg",alt:"Hot air balloons"},null,-1)),t("div",Z,[t("p",tt,k(m.name),1),t("p",null,k(o(m.price)),1),t("div",et,[t("button",{class:"text-center py-2",onClick:S=>s(r).add(m,-1)},"➖",8,ot),t("p",null,k(m.qty),1),t("button",{class:"text-center py-2",onClick:S=>s(r).add(m)},"➕",8,st),t("p",null,k(o(m.price*m.qty)),1)]),t("div",rt,[t("button",{class:"text-center text-sm py-2 uppercase",onClick:S=>s(r).remove(m.id)},"Remove",8,nt)])])]))),256))]),e[5]||(e[5]=t("hr",null,null,-1)),t("div",at,[t("div",it,[e[2]||(e[2]=t("p",null,"Subtotal",-1)),t("p",null,k(s(a)),1)]),t("div",ct,[s(i)>0&&s(l)!==void 0?(p(),T(P,{key:0,totalPrice:s(i),isUserAuthenticated:s(n)},null,8,["totalPrice","isUserAuthenticated"])):w("",!0),e[3]||(e[3]=t("div",{class:"flex justify-center"},[t("p",{class:"text-md font-bold"},"OR")],-1)),s(i)>0&&s(l)!==void 0?(p(),T(b,{key:1,totalPrice:s(i),isUserAuthenticated:s(n)},null,8,["totalPrice","isUserAuthenticated"])):w("",!0)]),e[4]||(e[4]=t("div",{class:"flex justify-between gap-2 py-2"},[t("button",{class:"text-center py-2 uppercase w-full h-[2.5rem] md:w-1/2 bg-gray-400"}),t("button",{class:"text-center py-2 uppercase h-[2.5rem] w-full md:w-1/2 bg-gray-200"})],-1))])])}}};export{ft as default};
